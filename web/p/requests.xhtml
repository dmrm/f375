<ui:composition template="/WEB-INF/templates/laftemplate.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core">
    
    <f:metadata>
        <f:viewParam name="id"/>
        <f:viewParam name="ignored"/>
    </f:metadata>
    
    <ui:define name="tempTitle">Request</ui:define>
    
    <ui:define name="tempBody">
        <script>
            document.getElementById("requests").className += 'active';
        </script>
        <br/>
        <h:panelGroup layout="block" id="ignoredMessage" class="alert alert-info span10 offset1" rendered="#{ignored}">
            <button class="close" data-dismiss="alert" type="button" onclick="getElementById('ignoredMessage').style.display = 'none'">
                ×
            </button>
            Request declined
        </h:panelGroup>
        <h:panelGroup layout="block" id="acceptedMessage" class="alert alert-success span10 offset1" rendered="#{not empty id}">
            <button class="close" data-dismiss="alert" type="button" onclick="getElementById('acceptedMessage').style.display = 'none'">
                ×
            </button>
            Request accepted. Affair <h:link outcome="affair.xhtml?id=#{affairMB.getAffairById(id).id}">##{affairMB.getAffairById(id).id}</h:link> is opened
        </h:panelGroup>        
        <div style="margin-top: 40px" class="container-fluid">
            <div class="row-fluid"> 
               <div class="span10 offset1 decor_block">
                    <table class="table table-condensed table-hover">
                         <thead>
                             <tr>
                                 <th class="span2">User</th>
                                 <th class="span6">Request</th>
                                 <th class="span2">Action</th>
                             </tr>
                         </thead>
                         <tbody>
                            <ui:repeat value="#{requestMB.requests}" var="req">
                                <tr>
                                    <td>#{req.requestBy}</td>
                                    <td>#{req.text}</td>
                                    <td>
                                        <h:form>
                                            <span class="btn-group">
                                                <h:commandButton action="#{requestsMB.acceptRequest(req.id)}" class="btn btn-primary" value="Accept"/>
                                                <h:commandButton action="#{requestsMB.declineRequest(req.id)}" class="btn" value="Decline"/>
                                            </span>
                                        </h:form>
                                    </td>
                                </tr>
                            </ui:repeat>
                         </tbody>
                    </table>
               </div>
            </div>
         </div>
    </ui:define>
    
</ui:composition>
